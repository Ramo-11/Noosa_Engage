<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Invoice</title>
    <link rel="stylesheet" href="/styles/createInvoices.css">
    <link rel="shortcut icon" href="/images/Logo-white.png">
</head>
<body>
    <%- include("../partials/nav.ejs") %>

    <div class="main-content">
        <div class="title-div">
            <h1>Create Invoice</h1>
        </div>
        <form id="invoiceForm" action="/api/createInvoice" method="POST" class="schedule-form">
            <div class="submitter submitter-invoice-number">
                <label for="invoiceNumber">Invoice Number:</label>
                <input type="text" name="invoiceNumber" id="invoiceNumber" required>
            </div>
            <div class="submitter submitter-name">
                <label for="firstName">Customer First Name:</label>
                <input type="text" name="firstName" id="firstName" required>
            </div>
            <div class="submitter submitter-name">
                <label for="lastName">Customer Last Name:</label>
                <input type="text" name="lastName" id="lastName" required>
            </div>
            <div class="submitter submitter-email">
                <label for="email">Customer Email:</label>
                <input type="email" name="email" id="email" required>
            </div>
            <div class="submitter submitter-date">
                <label for="sessionDate">Session Date:</label>
                <input type="date" name="sessionDate" id="sessionDate" required>
            </div>
            <div class="submitter submitter-date">
                <label for="dueDate">Due Date:</label>
                <input type="date" name="dueDate" id="dueDate" required>
            </div>
            <div class="submitter submitter-hours">
                <label for="hours">Hours:</label>
                <input type="number" name="hours" id="hours" required>
            </div>
            <div class="submitter submitter-price">
                <label for="price">Price per Hour:</label>
                <input type="number" step="0.01" name="price" id="price" required>
            </div>
            <div class="submitter submitter-total">
                <label for="total">Total:</label>
                <input type="number" step="0.01" name="total" id="total" readonly>
            </div>
            <div class="error-message" id="errorMessage">Please fill in all required fields.</div> <!-- Error message -->
            <button type="submit" class="submitButton">Submit</button>
        </form>
    </div>
    <%- include("../partials/footer.ejs") %>

    <script>
        // Automatically calculate the total when price or quantity changes
        document.getElementById('price').addEventListener('input', calculateTotal);
        document.getElementById('hours').addEventListener('input', calculateTotal);

        function calculateTotal() {
            const hours = parseFloat(document.getElementById('hours').value) || 0;
            const price = parseFloat(document.getElementById('price').value) || 0;
            document.getElementById('total').value = (hours * price).toFixed(2);
        }

        document.getElementById('invoiceForm').addEventListener('submit', function(event) {
            const requiredFields = document.querySelectorAll('input[required]');
            let allFilled = true; // Flag to track if all fields are filled
            const errorMessage = document.getElementById('errorMessage');

            // Check each required field
            requiredFields.forEach(function(field) {
                if (!field.value) {
                    allFilled = false; // Set flag to false if a required field is empty
                }
            });

            if (!allFilled) {
                event.preventDefault(); // Prevent form submission
                errorMessage.style.display = 'block'; // Show error message
            } else {
                errorMessage.style.display = 'none'; // Hide error message if all fields are filled
            }
        });
    </script>
</body>
</html>
